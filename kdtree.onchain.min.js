const KdT={build(t,s=(t[0]||[]).length,e=0,i=t.length){return i?this.node(this.sort(t,e%s),~~(i/2),s,e):null},node(t,s,e,i){return(new Map).set("p",t[s]).set("a",i%e).set("l",s?this.build(t.slice(0,s),e,i+1):null).set("r",s?this.build(t.slice(s),e,i+1):null)},sort:(t,s)=>t.slice().sort((t,e)=>t[s]<e[s]?-1:t[s]>e[s]?1:0),d:(t,s)=>t.reduce((t,e,i)=>t+(e-s[i])**2,0),near(t,s,e=1,i=[]){return t?(this.reg(i,t.get("p"),s,e),this.s(i,s,e,t.get("p"),t.get("a"),this.nf(s,...t.values()))):i},s(t,s,e,i,n,r){return this.sf(this.near(r[0],s,e,t),s,e,this.d([i[n]],[s[n]]),r[1])},sf(t,s,e,i,n){return t.find(t=>this.d(t,s)>=i)?this.near(n,s,e,t):t},reg(t,s,e,i){t.length<i?this.push(t,s):this.put(t,s,e,this.d(s,e))},push(t,s){-1==t.map(t=>String(t)).indexOf(String(s))&&t.push(s)},put(t,s,e,i,n){(n=t.findIndex(t=>i<this.d(t,e)))>-1&&(t[n]=s)},nf:(t,s,e,i,n)=>t[e]<=s[e]?[i,n]:[n,i]};