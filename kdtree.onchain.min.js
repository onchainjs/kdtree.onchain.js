KdT={ree:(e,d=(e[0]||[]).length,n=0,s=e.length)=>s?KdT.node(KdT.sort(e,n%d),~~(s/2),d,n):null,node:(e,d,n,s)=>(new Map).set("p",e[d]).set("a",s%n).set("l",d?KdT.ree(e.slice(0,d),n,s+1):null).set("r",d?KdT.ree(e.slice(d),n,s+1):null),sort:(e,d)=>e.slice().sort((e,n)=>e[d]<n[d]?-1:e[d]>n[d]?1:0),d:(e,d)=>e.reduce((e,n,s)=>e+(n-d[s])**2,0),near:(e,d,n=1,s=[])=>e?(KdT.reg(s,e.get("p"),d,n),KdT.s(s,d,n,e.get("p"),e.get("a"),KdT.nf(d,...e.values()))):s,s:(e,d,n,s,t,K)=>KdT.sf(KdT.near(K[0],d,n,e),d,n,KdT.d([s[t]],[d[t]]),K[1]),sf:(e,d,n,s,t)=>e.find(e=>KdT.d(e,d)>=s)?KdT.near(t,d,n,e):e,reg(e,d,n,s){e.length<s?KdT.push(e,d):KdT.put(e,d,n,KdT.d(d,n))},push(e,d){-1==e.map(e=>String(e)).indexOf(String(d))&&e.push(d)},put(e,d,n,s,t){(t=e.findIndex(e=>s<KdT.d(e,n)))>-1&&(e[t]=d)},nf:(e,d,n,s,t)=>e[n]<=d[n]?[s,t]:[t,s]};